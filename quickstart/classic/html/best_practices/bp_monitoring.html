<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Best Practices for Monitoring</title>
<link type="text/css" rel="stylesheet" href="../css/qs.css">
<script type="text/javascript" src="../css/qsfuncs.js"></script>
</head>
<body onload="javascript:qsInit();">
<div id="toppane"></div>
<div id="leftpane"></div>
<div id="content">

<span class="PageTitle-navy">Best Practices for Monitoring</span>
<p>Monitoring is necessary for all databases, and TimesTen is no exception. Monitoring allows for the quick diagnosis of database performance / functionality issues, and allows you to take quick action in case any problem or performance degradation is detected. This page recommends the top methods for monitoring a TimesTen database.</p><ul><li><span >Monitor TimesTen using Oracle Enterprise Manager (OEM)</span></li><li><span >Use the ttStats Utility</span></li><li><span >Monitor Key TimesTen Database Statistics</span></li><li><span >Measure SQL Execution Times</span></li><li><span >Monitor TimesTen Replication</span></li>
<li><span >Monitor TimesTen Application-Tier Database Cache</span></li>
</ul><h2>General Monitoring Tips</h2><h3>Monitor TimesTen Using Oracle Enterprise Manager (OEM)</h3>
<p>Customers with OEM Cloud Control may download the TimesTen plug-in for Enterprise Manager to monitor key configuration and performance metrics, as well as set up alerts based on user-defined statistic thresholds. Metrics monitored by Enterprise Manager can also be found in TimesTen system tables and outputs of TimesTen built-ins. OEM wraps the system performance information in an easily-understandable user interface. OEM allows you to view graphs of historical and real-time database performance as well as set up alert triggers when certain metric thresholds are surpassed. </p><p>If you are looking for a tool that can comprehensively monitor a TimesTen database and provide real-time information presented graphically, consider using the TimesTen plug-in for OEM Grid / Cloud control.</p><p><span >See the </span><a href="../tools/emplugin.html">Enterprise Manager QuickStart page<span ></span></a><span > for interactive demos showing how to deploy, configure and undeploy the TimesTen plugin on EM </span></p>
<p>See the <a href="bp_em.html">Best Practices for Enterprise Manager plug-in</a> for plug-in configuration recommendations.</p>
<h3>Use the ttStats Utility</h3><p>The <a target="_blank" class="doclink" href="http://docs.oracle.com/database/timesten-18.1/e61204/util.htm#TTREF802">ttStats</a> utility is a tool that captures real-time system statistics. It can be used to monitor and collect critical TimesTen metrics and display them in a readable format on the command line, or to generate comparisons (reports) of the conditions of a database at two periods of time (snapshots), rendered as an html file. </p>
<p>The primary intended usage for ttStats is for users to capture performance snapshots of their TimesTen database. ttStats can capture database performance statistics such as SQL statement execution counts, top SQL statements, checkpoint and transaction log operations, replication and cache group operations, locking information, as well as other database activities and configuration options. Performance statistics between two ttStats snapshots captured can then be compared and analyzed, which is useful for database tuning.</p><p>For more information and an example of how to use the utility, consult the <a target="_blank" class="doclink" href="http://docs.oracle.com/database/timesten-18.1/e61204/util.htm#TTREF802">TimesTen documentation for ttStats</a></p>
<p>If you would like to build your own monitoring capability that leverages the tt_stats PL/SQL package, you can view the <a target="_blank" class="doclink" href="http://docs.oracle.com/database/timesten-18.1/e61206/t_stats.htm#TTPLP71655">TT_STATS procedures</a> in the PL/SQL Packages Reference. Leveraging these stored procedures, you can create an in-house script that captures ttStats snapshots at fixed time intervals.</p>
<h3>Monitor Key TimesTen Database Statistics
</h3>
TimesTen collects a large set of statistics during runtime in its system tables. Monitoring TimesTen effectively means periodically querying the contents of system tables, either through direct SQL queries or TimesTen built-in procedures. If you would like to write your own custom script to constantly monitor key TimesTen statistics, follow these tips:
<ul><li>Monitor the statistics in the <a target="_blank" class="doclink" href="http://docs.oracle.com/database/timesten-18.1/e61205/systemtables.htm#TTSYS439">SYS.SYSTEMSTATS</a> table. These tables contain information about system performance and system wide monitoring statistics</li><li>Use the <a target="_blank" class="doclink" href="http://docs.oracle.com/database/timesten-18.1/e61195/ttisql.htm#TTOPR690">ttIsql monitor command</a>, which <span >displays </span><span >statistics on database space usage, number of connections, checkpoints, lock timeouts, commits, rollbacks and other information collected since the last time the database was loaded into memory. Running this command is the equivalent of doing a &quot;select * &quot; from the <a target="_blank" class="doclink" href="http://docs.oracle.com/database/timesten-18.1/e61205/systemtables.htm#TTSYS372">SYS.MONITOR</a> table</span></li><li>In times of transaction volume spikes, long running transactions, or any transactions that require TimesTen to hold bookmarks (replication, AWT, etc), the TimesTen in-memory transaction log buffer may fill up, and TimesTen performance may be partially bottlenecked by disk I/O, which could lead to decreased system performance. To guard against this, use the <a target="_blank" class="doclink" href="http://docs.oracle.com/database/timesten-18.1/e61204/proced.htm#TTREF261">ttLogHolds</a> and <a target="_blank" class="doclink" href="http://docs.oracle.com/database/timesten-18.1/e61204/proced.htm#TTREF241">ttCkptHistory</a> built-ins periodically to monitor excessive transaction log accumulation. See<a target="_blank" class="doclink" href="http://docs.oracle.com/database/timesten-18.1/e61195/trans.htm#TTOPR714"> this documentation link</a> for more information</li></ul><h3>Measure SQL Execution Times</h3><p>New in TimesTen 11.2.2.5 is the ability to quickly, simply and efficiently measure execution time of SQL operations, to help determine which SQL statements are performing well / poorly. To minimize overhead and maximize query performance, new built-ins sample the execution times of commands as they are executed. If you want to gauge the performance of SQL queries with more granularity, use these built-ins:</p><ol>
  <li><a target="_blank" class="doclink" href="http://docs.oracle.com/database/timesten-18.1/e61204/proced.htm#TTREF800">ttStatsConfig</a> -- controls the sampling configuration parameters for statistics collection</li>
<li><a target="_blank" class="doclink" href="http://docs.oracle.com/database/timesten-18.1/e61204/proced.htm#TTREF801">ttSQLExecutionTimeHistogram</a> -- displays a histogram of SQL execution times for either a single SQL command or all SQL commands in the command cache, if sampling is enabled</li>
<li><a target="_blank" class="doclink" href="http://docs.oracle.com/database/timesten-18.1/e61204/proced.htm#TTREF306">ttSQLCmdCacheInfo</a> -- returns all compiled statements in the TimesTen SQL command cache and reflects the number of SQL command fetches and their execution times</li>
</ol>

<p>For more information about the utilities, consult the documentation for <a target="_blank" class="doclink" href="http://docs.oracle.com/database/timesten-18.1/e61204/proced.htm#TTREF800">ttStatsConfig</a>, <a target="_blank" class="doclink" href="http://docs.oracle.com/database/timesten-18.1/e61204/proced.htm#TTREF801">ttSQLExecutionTimeHistogram</a>, and <a target="_blank" class="doclink" href="http://docs.oracle.com/database/timesten-18.1/e61204/proced.htm#TTREF306">ttSQLCmdCacheInfo</a>. Note that all these built-ins require the ADMIN privilege to run.</p>
<p>Here are some recommendations when using these built-ins to measure execution times:</p><ul><li><span >Measuring SQL execution times introduces a slight performance overhead, as execution time capture happens within the critical path of a SQL query. Thus, you should plan to measure only the mission-critical database transactions.</span></li><li><span >Take caution when setting the value of SQLCmdSampleFactor, as this determines how frequently execution time capture happens</span></li></ul><h2>TimesTen Replication Monitoring</h2><p>This section lists high-level recommendations for monitoring TimesTen databases configured with replication. We recommend that you read the <a href="bp_replication.html">Best Practices for Replication</a> and <a href="../admin/rep.html">Configuring Replication Between TimesTen Databases</a> sections first before diving into this section, as the topics here are more advanced. Detailed information about monitoring replication can be found <a target="_blank" class="doclink" href="http://docs.oracle.com/database/timesten-18.1/e61197/monitor.htm#TTREP440">in the TimesTen documentation</a>.</p>
<p>This section lists high-level recommendations for monitoring TimesTen replication:</p><ul>
  <li>The replication agent and its associated processes must be running for replication to be successful.
    <ul>
      <li>When accessing TimesTen via command line, show state of replication agents by running <a target="_blank" class="doclink" href="http://docs.oracle.com/database/timesten-18.1/e61198/tools.htm#TTTRB122">ttStatus</a>, then looking for the processes of type &quot;Replication&quot;</li>
      <li>When accessing TimesTen from a program, utilize TimesTen built-in procedures. Specifically, <a href="http://docs.oracle.com/database/timesten-18.1/e61204/proced.htm#TTREF246" target="_blank" class="doclink">ttDataStoreStatus</a> obtains the status of replication agents</li>
    </ul>
  </li>
  <li>Database policy settings, which includes information about the replication agent can be viewed using the<span class="codetext"> ttAdmin -query &lt;DSN&gt;</span> utility</li>
  <li>Use the <a target="_blank" class="doclink" href="http://docs.oracle.com/database/timesten-18.1/e61197/monitor.htm#TTREP472">ttRepAdmin</a> utility to display replication topologies and monitor replication status. ttRepAdmin provides a robust set of features for replication monitoring. Some frequently used ttRepAdmin arguments are:
    <ul>
      <li>ttRepAdmin -dsn &lt;DSN&gt; -self -list</li>
      <li>ttRepAdmin -dsn &lt;DSN&gt; -receiver -list</li>
      <li>ttRepAdmin -showconfig -dsn &lt;DSN&gt;</li>
      <li>ttRepAdmin -dsn &lt;DSN&gt; -bookmark</li>
      <li>ttRepAdmin -showstatus &lt;DSN&gt;</li>
    </ul>
  </li>
  <li>Information about subscriber databases can be found by querying system replication tables such as <a target="_blank" class="doclink" href="http://docs.oracle.com/database/timesten-18.1/e61205/replicationtables.htm#TTSYS395">TREP.REPPEERS</a>, <a target="_blank" class="doclink" href="http://docs.oracle.com/database/timesten-18.1/e61205/replicationtables.htm#TTSYS399">TTREP.TTSTORES</a>, and <a target="_blank" class="doclink" href="http://docs.oracle.com/database/timesten-18.1/e61205/systemtables.htm#TTSYS372">SYS.MONITOR</a> tables</li><li>Database replication configuration can be seen using the <a target="_blank" class="doclink" href="http://docs.oracle.com/database/timesten-18.1/e61197/monitor.htm#TTREP462">repschemes</a> command in ttIsql</li>
  <li>The status of one or more replicated databases can be shown using the <a target="_blank" class="doclink" href="http://docs.oracle.com/database/timesten-18.1/e61204/proced.htm#TTREF284">ttReplicationStatus</a> built-in procedure</li>
<li>The location of bookmarks, which is the mechanism used for tracking successfully replicated transactions, can be viewed using the <a target="_blank" class="doclink" href="http://docs.oracle.com/database/timesten-18.1/e61204/proced.htm#TTREF219">ttBookMark()</a> built-in procedure</li>
<li>The receipt status of database subscribers with respect to its database masters can be viewed using the <a target="_blank" class="doclink" href="http://docs.oracle.com/database/timesten-18.1/e61204/proced.htm#TTREF298">ttRepSyncSubscriberStatus</a>  built-in procedure</li><li>Statistics for the remaining transactions that need to be replicated can be viewed using <a target="_blank" class="doclink" href="http://docs.oracle.com/database/timesten-18.1/e61204/util.htm#TTREF377">ttXactLog</a>, specifying the -logAnalyze argument. Shown below is an example:
<blockquote><pre>$ ttXactLog -v1 -logAnalyze rep1
Summary:
Total transactions left to replicate: 1
Total rows left to replicate: 1
Size of transactions left to replicate:    120 KB
Size of rows left to replicate:     76 KB
Largest transaction left to replicate:   1.26
Total inserts remaining: 1
StartLSN = 0. 7354632
EndLSN = 1.9462762</pre></blockquote></li></ul>
<p>More information can be found in the <a href="bp_replication.html">Best Practices for Replication</a> section.</p></li></ul>
<h2>TimesTen Cache Monitoring</h2>
<p>This section lists high-level recommendations for monitoring TimesTen Cache. In an environment where TimesTen is used as a cache for an Oracle Database, it is especially important to monitor both the TimesTen and Oracle Databases. This section only describes the monitoring of TimesTen database.</p>
<p>To cache a set of Oracle Database data into TimesTen, you define a SQL object known as a &quot;cache group&quot;. There are two types of cache groups, readonly cache groups and asynchronous write-through (AWT) cache groups. For a basic understanding of concepts, we strongly recommend that you read through the <a href="bp_timestencache.html">Best Practices for TimesTen Cache</a> and <a href="../admin/timesten_cache.html">Configuring TimesTen Application-Tier Database Cache</a> (TimesTen Cache) sections first before diving into this section, as the topics here are more advanced. </p>
<h3>Monitoring Read-Only Cache Groups</h3><p>A cache group is said to be &quot;read-only&quot; if all changes to the underlying table(s) occur in the Oracle Database, and are subsequently refreshed into TimesTen. A read-only cache group can be configured to be an &quot;autorefresh&quot; cache group if the delta changes to the underlying Oracle Database tables are refreshed periodically every predefined period of time. Here are some recommended ways to monitor read-only cache groups:</p><ul><li>Use the ttIsql utility's <a target="_blank" class="doclink" href="http://docs.oracle.com/database/timesten-18.1/e61196/manage.htm#TTCAC308">cachegroups</a> command to obtain information about the cache groups defined in the database</li><li>Use the <a target="_blank" class="doclink" href="http://docs.oracle.com/database/timesten-18.1/e61204/proced.htm#TTREF220">ttCacheAutorefreshStatsGet</a> built-in procedure to return information about the latest operations of an autorefresh cache group</li><li>Run &lt;TIMESTEN_INSTALL_DIR&gt;/oraclescripts/cacheInfo.sql on the Oracle database to gather information for autorefresh cache groups</li><li>Use SNMP traps to alert you when autorefresh problems occur</li></ul>
<p><span >More information can be found in the <a href="bp_timestencache.html">Best Practices for TimesTen Cache</a> section as well as </span><a target="_blank" class="doclink" href="http://docs.oracle.com/database/timesten-18.1/e61198/cache_trouble.htm#TTTRB247">the documentation</a>.</p>
<h3>Monitoring Asynchronous Write-Through Cache Groups</h3><p>A cache group is said to be an &quot;asynchronous write-through&quot; (AWT) cache group if all changes to the underlying table(s) occur in the TimesTen database, and are subsequently flushed to the underlying Oracle Database. Here are some recommended ways to monitor AWT cache groups:</p><ul><li>Use the ttIsql utility's <a target="_blank" class="doclink" href="http://docs.oracle.com/database/timesten-18.1/e61196/manage.htm#TTCAC308">cachegroups</a> command to obtain information about the cache groups defined in the database</li><li>Return statistics for AWT cache groups using:<br />ttRepAdmin -showstatus -awtmoninfo<br />Note that before running this query, the replication agent must be running and you must set<br/> <span class="codetext">ttCacheAWTMonitorConfig("on",&lt;sampling_frequency&gt;)</span><br />
For accuracy and performance, a sampling factor of '16' is recommended</li>
<li>Check whether asynchronous writethrough operations are keeping up with the rate of updates on cache tables in AWT cache groups by querying the LAST_LOG_FILE, REPHOLD_LOG_FILE and REPHOLD_LOG_OFF columns of the <a target="_blank" class="doclink" href="http://docs.oracle.com/database/timesten-18.1/e61205/systemtables.htm#TTSYS372">SYS.MONITOR</a> table</li><li>If you experience poor AWT cache group performance, see <a target="_blank" class="doclink" href="http://docs.oracle.com/database/timesten-18.1/e61198/awt_trouble.htm#TTTRB278">this section</a> for possible causes. </li></ul>
<p><span >More information can be found in the <a href="bp_timestencache.html">Best Practices for TimesTen Cache</a> section as well as </span><a target="_blank" class="doclink" href="http://docs.oracle.com/database/timesten-18.1/e61198/awt_trouble.htm#TTTRB277">the documentation</a>.</p>
<p>&nbsp;</p>
</div>
<div id="footer"/>
</body>

</html>
